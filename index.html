<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>BeefMusic ‚Äì Crea canciones desde peticiones</title>

    <!-- Fuente futurista y limpia -->
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">

    <style>
        /* LAYOUT GENERAL */
        .page {
            max-width: 1200px;
            margin: 0 auto;
            padding: 24px 20px 80px;
        }

        /* HEADER CON BOTONES AND USER */
        .header-actions {
            display: flex;
            align-items: center;
            justify-content: flex-end;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 24px;
        }

        .user-profile {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-right: auto;
        }

        .user-profile-text {
            display: flex;
            flex-direction: column;
            font-size: 0.8rem;
        }

        .user-profile-label {
            opacity: 0.7;
        }

        .user-profile-name {
            font-weight: 500;
        }

        .user-avatar {
            width: 32px;
            height: 32px;
            border-radius: 999px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
        }

        /* HERO */
        .hero {
            display: flex;
            gap: 32px;
            align-items: stretch;
            margin-bottom: 56px;
        }

        .hero-left,
        .hero-right {
            flex: 1;
            min-width: 0;
        }

        .hero-actions {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 18px 0;
        }

        .hero-meta {
            display: flex;
            flex-wrap: wrap;
            gap: 16px;
        }

        .hero-meta-item {
            min-width: 220px;
        }

        /* GRID SECCIONES */
        .section {
            margin-bottom: 56px;
        }

        .section-header {
            max-width: 720px;
            margin-bottom: 24px;
        }

        .grid-3 {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 18px;
        }

        .songs-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
            gap: 18px;
        }

        .song-card {
            display: flex;
            flex-direction: row;
            gap: 12px;
        }

        .song-thumb {
            flex-shrink: 0;
            width: 60px;
        }

        .song-body {
            flex: 1;
            min-width: 0;
        }

        /* STATS */
        .stats-section {
            display: flex;
            flex-direction: column;
            gap: 24px;
        }

        .stats-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            gap: 16px;
            flex-wrap: wrap;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 18px;
        }

        /* DISCORD CTA reutiliza .hero-actions */

        /* FOOTER */
        footer {
            margin-top: 40px;
            padding-top: 16px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 12px;
            flex-wrap: wrap;
            font-size: 0.85rem;
        }

        .footer-links {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
        }

        /* MODALES */
        .modal-backdrop {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.7);
            display: none; /* se pasa a flex desde JS */
            align-items: center;
            justify-content: center;
            padding: 16px;
            z-index: 50;
        }

        .modal {
            width: 100%;
            max-width: 550px;
            max-height: 90vh;
            overflow: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 8px;
        }

        .modal-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 12px;
            flex-wrap: wrap;
        }

        .modal-status {
            font-size: 0.8rem;
            opacity: 0.85;
        }

        /* BREAKPOINTS */

        @media (max-width: 960px) {
            .hero {
                flex-direction: column;
            }

            .hero-right {
                order: -1; /* visual arriba si quieres, quita esta l√≠nea si no te mola */
            }

            .hero-meta {
                flex-direction: column;
            }

            .stats-header {
                flex-direction: column;
                align-items: flex-start;
            }
        }

        @media (max-width: 768px) {
            .page {
                padding: 20px 16px 60px;
            }

            .header-actions {
                flex-direction: column;
                align-items: stretch;
            }

                .header-actions .btn {
                    width: 100%;
                    text-align: center;
                }

            .user-profile {
                margin-right: 0;
                width: 100%;
                justify-content: flex-start;
            }

            .song-card {
                flex-direction: column;
            }

            .song-thumb {
                width: 100%;
            }

            .hero-actions {
                flex-direction: column;
                align-items: stretch;
            }

                .hero-actions .btn {
                    width: 100%;
                }

            .stats-grid {
                grid-template-columns: 1fr;
            }

            footer {
                flex-direction: column;
                align-items: flex-start;
            }
        }

        @media (max-width: 480px) {
            .page {
                padding: 16px 12px 48px;
            }

            .hero-title {
                font-size: 2.2rem;
            }

            .section-header {
                margin-bottom: 18px;
            }

            .modal {
                max-width: 100%;
                border-radius: 16px;
            }
        }
    </style>
</head>
<body>
    <div class="page">
        <div class="header-actions">
            <div class="user-profile">
                <div class="user-avatar" id="user-avatar">U</div>
                <div class="user-profile-text">
                    <span class="user-profile-label">Conectado</span>
                    <span class="user-profile-name" id="user-name-display">@usuario</span>
                </div>
            </div>

            <button class="btn btn-ghost" id="open-request-1">
                Enviar petici√≥n
            </button>

            <!-- NUEVOS BOTONES -->
            <button class="btn btn-ghost" id="open-suggestion">
                Sugerencia
            </button>
            <button class="btn btn-ghost" id="open-report">
                Reportar problema
            </button>

            <!-- NUEVO BOT√ìN PERFIL SONORO -->
            <button class="btn btn-ghost" onclick="window.location.href='perfil.html'">
                Perfil sonoro
            </button>

            <button class="btn btn-primary" onclick="window.location.href='canciones.html'">
                <span class="btn-icon">‚ñ∂</span>
                Ver canciones
            </button>
            <button class="btn btn-ghost" id="user-logout-btn">
                Cerrar sesi√≥n
            </button>
        </div>

        <!-- HERO -->
        <section class="hero">
            <div class="hero-left">
                <div class="hero-kicker">
                    <div class="hero-kicker-dot"></div>
                    <span>Taller de temas a la carta</span>
                </div>

                <h1 class="hero-title">
                    <span class="hero-title-main">BEEF</span>
                    <span class="hero-title-sub">MUSIC</span>
                </h1>

                <div class="hero-highlight">
                    Me mandas la idea ‚Üí pasa por Discord ‚Üí sale convertida en canci√≥n
                </div>

                <p class="hero-desc">
                    <strong>BeefMusic</strong> es un sitio donde las historias de la gente acaban
                    hechas canci√≥n. T√∫ escribes la movida que quieres contar, la petici√≥n entra
                    en el <strong>Discord</strong> y desde ah√≠ se trabaja hasta que sale un tema
                    listo para escuchar y compartir desde la web.
                </p>

                <div class="hero-actions">
                    <button class="btn btn-primary" id="open-request-2">
                        <span class="btn-icon">‚úâ</span>
                        Enviar petici√≥n ahora
                    </button>
                    <a href="canciones.html" class="btn btn-ghost">
                        Ver √∫ltimas canciones
                    </a>
                </div>
                <div class="hero-meta">
                    <div class="hero-meta-item">
                        <span>Comunidad</span>
                        <div><span class="hero-meta-accent">+200</span> ideas convertidas en letras y beats</div>
                    </div>
                    <div class="hero-meta-item">
                        <span>Estilo</span>
                        <div>Beefs, diss, drill, dembow, trap y lo que se venga</div>
                    </div>
                </div>
            </div>

            <!-- HERO VISUAL -->
            <div class="hero-right">
                <div class="hero-visual">
                    <div class="hero-visual-overlay"></div>
                    <div class="hero-visual-main">
                        <div class="hero-visual-content">
                            <div class="hero-tag">Beats, letras y piques</div>

                            <div class="hero-character-silhouette">
                                <div class="hero-character-circle"></div>
                            </div>

                            <div class="hero-chip-row">
                                <div class="hero-chip">
                                    <div class="hero-chip-label">Estado</div>
                                    <div class="hero-chip-value">
                                        <span class="hero-chip-dot"></span>
                                        Aceptando nuevas historias
                                    </div>
                                </div>
                                <div class="hero-chip">
                                    <div class="hero-chip-label">Modo</div>
                                    <div class="hero-chip-value">Beat a medida + letra si hace falta</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- C√ìMO FUNCIONA -->
        <section id="como-funciona" class="section">
            <div class="section-header">
                <div class="section-kicker">Flow BeefMusic</div>
                <h2 class="section-title">De lo que cuentas al tema final</h2>
                <p class="section-subtitle">
                    Aqu√≠ no hay plantillas: cada canci√≥n sale de una historia real que alguien ha pedido.
                    Todo pasa por la web, por Discord y acaba guardado en la colecci√≥n de BeefMusic.
                </p>
            </div>

            <div class="grid-3">
                <article class="feature-card">
                    <div class="feature-icon">1</div>
                    <h3 class="feature-title">Manda la historia</h3>
                    <p class="feature-desc">
                        Rellena el formulario con nombres, detalles, frases que quieras que salgan
                        y el estilo que te gusta. La petici√≥n llega directa a un canal privado
                        del servidor de Discord.
                    </p>
                </article>

                <article class="feature-card">
                    <div class="feature-icon">2</div>
                    <h3 class="feature-title">Se cocina en Discord</h3>
                    <p class="feature-desc">
                        Se revisa la petici√≥n, se decide el enfoque, se monta el beat, se escribe la letra
                        y se ajusta todo para que suene como tiene que sonar: serio y con actitud.
                    </p>
                </article>

                <article class="feature-card">
                    <div class="feature-icon">3</div>
                    <h3 class="feature-title">Sale a la luz</h3>
                    <p class="feature-desc">
                        Cuando el tema est√° listo, se sube a BeefMusic con su portada y detalles.
                        As√≠ puedes escucharlo, compartirlo y ense√±ar de d√≥nde sali√≥ la idea.
                    </p>
                </article>
            </div>
        </section>

        <!-- STATS -->
        <section id="stats" class="stats-section section">
            <div class="stats-header">
                <div>
                    <div class="section-kicker">Actividad del proyecto</div>
                    <h2 class="stats-title">C√≥mo se est√° moviendo BeefMusic</h2>
                </div>
                <div class="stats-tagline">
                    Cada vez que entra una petici√≥n nueva o se publica un tema, estos n√∫meros cambian.
                </div>
            </div>

            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-label">Canciones en la colecci√≥n</div>
                    <div class="stat-value">120+</div>
                    <div class="stat-extra">Temas montados a partir de historias reales.</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Peticiones totales</div>
                    <div class="stat-value">480+</div>
                    <div class="stat-extra">Ideas que han pasado por la web y por Discord.</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Gente implicada</div>
                    <div class="stat-value">15</div>
                    <div class="stat-extra">Productores, voces, composici√≥n y mezcla.</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Sabores distintos</div>
                    <div class="stat-value">8+</div>
                    <div class="stat-extra">Trap, drill, reggaet√≥n, dembow, boom bap y m√°s.</div>
                </div>
            </div>
        </section>

        <!-- CANCIONES -->
        <section id="canciones" class="section">
            <div class="section-header">
                <div class="section-kicker">√öltimos lanzamientos</div>
                <h2 class="section-title">Algunos de los temas que han salido de aqu√≠</h2>
                <p class="section-subtitle">
                    De momento son ejemplos, pero la idea es que esta secci√≥n se alimente sola con
                    las canciones que se vayan publicando desde las peticiones reales.
                </p>
            </div>

            <div class="songs-grid">
                <!-- Song 1 -->
                <article class="song-card">
                    <div class="song-thumb">
                        <div class="song-wave"></div>
                    </div>
                    <div class="song-body">
                        <div class="song-title">‚ÄúC√≥digo de Barrio‚Äù</div>
                        <div class="song-meta">
                            <span>Estilo: Drill</span>
                            <span>Duraci√≥n: 3:02</span>
                        </div>
                        <div class="song-req">
                            Petici√≥n de <strong>@user_404</strong> ‚Äì historia de lealtad, movidas en el bloque
                            y alguien que ya no es de fiar.
                        </div>
                        <div class="song-meta">
                            <span class="song-badge">Publicada</span>
                            <span>Ver detalles ‚Üí</span>
                        </div>
                    </div>
                </article>

                <!-- Song 2 -->
                <article class="song-card">
                    <div class="song-thumb">
                        <div class="song-wave"></div>
                    </div>
                    <div class="song-body">
                        <div class="song-title">‚ÄúDembow del Server‚Äù</div>
                        <div class="song-meta">
                            <span>Estilo: Dembow</span>
                            <span>Duraci√≥n: 2:41</span>
                        </div>
                        <div class="song-req">
                            Petici√≥n de <strong>@maria_beats</strong> ‚Äì tema r√°pido y pegado para
                            levantar el Discord a las tantas.
                        </div>
                        <div class="song-meta">
                            <span class="song-badge">Publicada</span>
                            <span>Escuchar ‚Üí</span>
                        </div>
                    </div>
                </article>

                <!-- Song 3 -->
                <article class="song-card">
                    <div class="song-thumb">
                        <div class="song-wave"></div>
                    </div>
                    <div class="song-body">
                        <div class="song-title">‚ÄúBeef Digital‚Äù</div>
                        <div class="song-meta">
                            <span>Estilo: Trap</span>
                            <span>Duraci√≥n: 3:28</span>
                        </div>
                        <div class="song-req">
                            Petici√≥n an√≥nima ‚Äì diss en clave de juego contra un rival del server,
                            todo en modo roleplay.
                        </div>
                        <div class="song-meta">
                            <span class="song-badge">En revisi√≥n</span>
                            <span>Pr√≥ximamente</span>
                        </div>
                    </div>
                </article>
            </div>
        </section>

        <!-- DISCORD / CTA -->
        <section id="discord" class="section">
            <div class="stats-section">
                <div class="stats-header">
                    <div>
                        <div class="section-kicker">Comunidad</div>
                        <h2 class="stats-title">Tu petici√≥n acaba en el Discord y vuelve hecha canci√≥n</h2>
                    </div>
                    <div class="stats-tagline">
                        Cada idea que mandas desde la web se guarda y se manda a un canal del servidor,
                        donde se revisa y se decide c√≥mo convertirla en tema.
                    </div>
                </div>

                <div class="hero-actions">
                    <button class="btn btn-primary" id="open-request-3">
                        Enviar mi primera petici√≥n
                    </button>
                    <button class="btn btn-ghost" id="discord-join-btn">
                        Unirme al servidor de Discord
                    </button>
                </div>
            </div>
        </section>

        <!-- FOOTER -->
        <footer>
            <span>¬© <span id="year"></span> BeefMusic. Todos los derechos reservados.</span>
            <div class="footer-links">
                <a href="#">T√©rminos</a>
                <a href="#">Privacidad</a>
                <a href="#">Contacto</a>
            </div>
        </footer>
    </div>

    <!-- MODAL PETICI√ìN -->
    <div class="modal-backdrop" id="request-modal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">Enviar petici√≥n de canci√≥n</h3>
                <button class="modal-close" id="modal-close">‚úï</button>
            </div>
            <p class="modal-desc">
                Describe qu√© tipo de canci√≥n quieres y qu√© historia debe contar.
                Esta petici√≥n se enviar√° a un canal de Discord desde tu backend.
            </p>

            <form id="request-form">
                <div class="field">
                    <label for="nick">Tu nick o usuario</label>
                    <input id="nick" name="nick" type="text" placeholder="@tu_usuario" required />
                </div>
                <div class="field">
                    <label for="style">Estilo / g√©nero</label>
                    <input id="style" name="style" type="text" placeholder="Drill, trap, dembow, boom bap‚Ä¶" required />
                </div>
                <div class="field">
                    <label for="idea">Idea de la canci√≥n</label>
                    <textarea id="idea" name="idea" rows="4" placeholder="Cu√©ntanos la historia, nombres, frases clave, referencias..." required></textarea>
                    <small>Ejemplo: beef amistoso, historia de amor, intro para tu canal, etc.</small>
                </div>

                <div class="modal-footer">
                    <span class="modal-status" id="modal-status">
                        Rellena la info y env√≠a tu petici√≥n.
                    </span>
                    <button class="btn btn-primary" type="submit">
                        Enviar petici√≥n
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- MODAL SUGERENCIA -->
    <div class="modal-backdrop" id="suggestion-modal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">Enviar sugerencia</h3>
                <button class="modal-close" id="suggestion-modal-close">‚úï</button>
            </div>
            <p class="modal-desc">
                ¬øQu√© mejorar√≠as en BeefMusic? ¬øQu√© te gustar√≠a que a√±adiera a la web o al proyecto?
            </p>

            <form id="suggestion-form">
                <div class="field">
                    <label for="suggestion-nick">Tu nick o usuario (opcional)</label>
                    <input id="suggestion-nick" name="nick" type="text" placeholder="@tu_usuario" />
                </div>
                <div class="field">
                    <label for="suggestion-message">Tu sugerencia</label>
                    <textarea id="suggestion-message" name="mensaje" rows="4" placeholder="Cu√©ntame tu idea, mejora o feedback..." required></textarea>
                </div>

                <div class="modal-footer">
                    <span class="modal-status" id="suggestion-status">
                        Tus sugerencias ayudan a pulir BeefMusic.
                    </span>
                    <button class="btn btn-primary" type="submit">
                        Enviar sugerencia
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- MODAL REPORTE -->
    <div class="modal-backdrop" id="report-modal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">Reportar problema</h3>
                <button class="modal-close" id="report-modal-close">‚úï</button>
            </div>
            <p class="modal-desc">
                Si algo no funciona bien (bug, error, fallo visual...), rep√≥rtalo y lo reviso.
            </p>

            <form id="report-form">
                <div class="field">
                    <label for="report-nick">Tu nick o usuario (opcional)</label>
                    <input id="report-nick" name="nick" type="text" placeholder="@tu_usuario" />
                </div>
                <div class="field">
                    <label for="report-message">¬øQu√© ha pasado?</label>
                    <textarea id="report-message" name="mensaje" rows="4" placeholder="Explica el problema, qu√© estabas haciendo, pasos para reproducirlo..." required></textarea>
                </div>

                <div class="modal-footer">
                    <span class="modal-status" id="report-status">
                        Cuantos m√°s detalles des, m√°s f√°cil es arreglarlo.
                    </span>
                    <button class="btn btn-primary" type="submit">
                        Enviar reporte
                    </button>
                </div>
            </form>
        </div>
    </div>

    <script>
        const API_URL = "https://beefmusic-backend.onrender.com";

        (function () {
            const userToken = localStorage.getItem("beefmusic_user_token");
            if (!userToken) {
                // redirige al login de usuario
                window.location.href = "user-login.html";
            }
        })();

        // üë§ Mostrar el nombre de usuario en el header, avatar e autocompletar nicks
        const storedUserName = localStorage.getItem("beefmusic_user_name");
        if (storedUserName) {
            const userNameDisplay = document.getElementById("user-name-display");
            if (userNameDisplay) {
                userNameDisplay.textContent = "@" + storedUserName;
            }

            const avatarEl = document.getElementById("user-avatar");
            if (avatarEl) {
                avatarEl.textContent = storedUserName.charAt(0).toUpperCase();
            }

            const nickInput = document.getElementById("nick");
            if (nickInput && !nickInput.value) {
                nickInput.value = "@" + storedUserName;
            }

            const suggestionNickInput = document.getElementById("suggestion-nick");
            if (suggestionNickInput && !suggestionNickInput.value) {
                suggestionNickInput.value = "@" + storedUserName;
            }

            const reportNickInput = document.getElementById("report-nick");
            if (reportNickInput && !reportNickInput.value) {
                reportNickInput.value = "@" + storedUserName;
            }
        }

        // A√±o din√°mico en el footer
        document.getElementById("year").textContent = new Date().getFullYear();

        // Modales
        const requestModal = document.getElementById("request-modal");
        const suggestionModal = document.getElementById("suggestion-modal");
        const reportModal = document.getElementById("report-modal");

        const requestStatusEl = document.getElementById("modal-status");
        const suggestionStatusEl = document.getElementById("suggestion-status");
        const reportStatusEl = document.getElementById("report-status");

        function openRequestModal() {
            if (!requestModal) return;
            requestModal.style.display = "flex";
            if (requestStatusEl) {
                requestStatusEl.textContent = "Rellena la info y env√≠a tu petici√≥n.";
            }
        }

        function closeRequestModal() {
            if (!requestModal) return;
            requestModal.style.display = "none";
        }

        function openSuggestionModal() {
            if (!suggestionModal) return;
            suggestionModal.style.display = "flex";
            if (suggestionStatusEl) {
                suggestionStatusEl.textContent = "Tus sugerencias ayudan a pulir BeefMusic.";
            }
        }

        function closeSuggestionModal() {
            if (!suggestionModal) return;
            suggestionModal.style.display = "none";
        }

        function openReportModal() {
            if (!reportModal) return;
            reportModal.style.display = "flex";
            if (reportStatusEl) {
                reportStatusEl.textContent = "Cuantos m√°s detalles des, m√°s f√°cil es arreglarlo.";
            }
        }

        function closeReportModal() {
            if (!reportModal) return;
            reportModal.style.display = "none";
        }

        // Botones que abren el modal de petici√≥n
        ["open-request-1", "open-request-2", "open-request-3"].forEach((id) => {
            const btn = document.getElementById(id);
            if (btn) {
                btn.addEventListener("click", openRequestModal);
            }
        });

        const modalCloseBtn = document.getElementById("modal-close");
        if (modalCloseBtn) {
            modalCloseBtn.addEventListener("click", closeRequestModal);
        }

        if (requestModal) {
            requestModal.addEventListener("click", (e) => {
                if (e.target === requestModal) closeRequestModal();
            });
        }

        // Botones para sugerencias
        const openSuggestionBtn = document.getElementById("open-suggestion");
        if (openSuggestionBtn) {
            openSuggestionBtn.addEventListener("click", openSuggestionModal);
        }

        const suggestionCloseBtn = document.getElementById("suggestion-modal-close");
        if (suggestionCloseBtn) {
            suggestionCloseBtn.addEventListener("click", closeSuggestionModal);
        }

        if (suggestionModal) {
            suggestionModal.addEventListener("click", (e) => {
                if (e.target === suggestionModal) closeSuggestionModal();
            });
        }

        // Botones para reportes
        const openReportBtn = document.getElementById("open-report");
        if (openReportBtn) {
            openReportBtn.addEventListener("click", openReportModal);
        }

        const reportCloseBtn = document.getElementById("report-modal-close");
        if (reportCloseBtn) {
            reportCloseBtn.addEventListener("click", closeReportModal);
        }

        if (reportModal) {
            reportModal.addEventListener("click", (e) => {
                if (e.target === reportModal) closeReportModal();
            });
        }

        // ‚úÖ Env√≠o REAL del formulario de petici√≥n a tu backend (Render)
        const requestForm = document.getElementById("request-form");
        if (requestForm) {
            requestForm.addEventListener("submit", function (e) {
                e.preventDefault();

                const data = {
                    nick: this.nick.value,
                    style: this.style.value,
                    idea: this.idea.value,
                };

                if (requestStatusEl) {
                    requestStatusEl.textContent = "Enviando petici√≥n...";
                }

                fetch(API_URL + "/api/peticiones", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify(data),
                })
                    .then((res) => res.json())
                    .then((json) => {
                        if (json.error) {
                            if (requestStatusEl) {
                                requestStatusEl.textContent = "‚ùå Error: " + json.error;
                            }
                        } else {
                            if (requestStatusEl) {
                                requestStatusEl.textContent =
                                    "‚úÖ Petici√≥n enviada correctamente. ID: " + json.id;
                            }
                            this.reset();

                            const storedUserName = localStorage.getItem("beefmusic_user_name");
                            if (storedUserName) {
                                this.nick.value = "@" + storedUserName;
                            }
                        }
                    })
                    .catch((err) => {
                        console.error(err);
                        if (requestStatusEl) {
                            requestStatusEl.textContent = "‚ùå Error enviando la petici√≥n.";
                        }
                    });
            });
        }

        // ‚úÖ Env√≠o REAL de sugerencias
        const suggestionForm = document.getElementById("suggestion-form");
        if (suggestionForm) {
            suggestionForm.addEventListener("submit", function (e) {
                e.preventDefault();

                const data = {
                    nick: this.nick.value,
                    mensaje: this.mensaje.value,
                };

                if (suggestionStatusEl) {
                    suggestionStatusEl.textContent = "Enviando sugerencia...";
                }

                fetch(API_URL + "/api/sugerencias", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify(data),
                })
                    .then((res) => res.json())
                    .then((json) => {
                        if (json.error) {
                            if (suggestionStatusEl) {
                                suggestionStatusEl.textContent = "‚ùå Error: " + json.error;
                            }
                        } else {
                            if (suggestionStatusEl) {
                                suggestionStatusEl.textContent =
                                    "‚úÖ Sugerencia enviada correctamente. ID: " + json.id;
                            }
                            this.reset();

                            const storedUserName = localStorage.getItem("beefmusic_user_name");
                            if (storedUserName) {
                                this.nick.value = "@" + storedUserName;
                            }
                        }
                    })
                    .catch((err) => {
                        console.error(err);
                        if (suggestionStatusEl) {
                            suggestionStatusEl.textContent = "‚ùå Error enviando la sugerencia.";
                        }
                    });
            });
        }

        // ‚úÖ Env√≠o REAL de reportes
        const reportForm = document.getElementById("report-form");
        if (reportForm) {
            reportForm.addEventListener("submit", function (e) {
                e.preventDefault();

                const data = {
                    nick: this.nick.value,
                    mensaje: this.mensaje.value,
                };

                if (reportStatusEl) {
                    reportStatusEl.textContent = "Enviando reporte...";
                }

                fetch(API_URL + "/api/reportes", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify(data),
                })
                    .then((res) => res.json())
                    .then((json) => {
                        if (json.error) {
                            if (reportStatusEl) {
                                reportStatusEl.textContent = "‚ùå Error: " + json.error;
                            }
                        } else {
                            if (reportStatusEl) {
                                reportStatusEl.textContent =
                                    "‚úÖ Reporte enviado correctamente. ID: " + json.id;
                            }
                            this.reset();

                            const storedUserName = localStorage.getItem("beefmusic_user_name");
                            if (storedUserName) {
                                this.nick.value = "@" + storedUserName;
                            }
                        }
                    })
                    .catch((err) => {
                        console.error(err);
                        if (reportStatusEl) {
                            reportStatusEl.textContent = "‚ùå Error enviando el reporte.";
                        }
                    });
            });
        }

        // Logout
        const userLogoutBtn = document.getElementById("user-logout-btn");
        if (userLogoutBtn) {
            userLogoutBtn.addEventListener("click", () => {
                localStorage.removeItem("beefmusic_user_token");
                localStorage.removeItem("beefmusic_user_name");
                window.location.href = "user-login.html";
            });
        }

        // Discord
        const discordBtn = document.getElementById("discord-join-btn");
        if (discordBtn) {
            discordBtn.addEventListener("click", () => {
                window.open("https://discord.gg/DywmTT78Wx", "_blank");
            });
        }
    </script>
</body>
</html>
